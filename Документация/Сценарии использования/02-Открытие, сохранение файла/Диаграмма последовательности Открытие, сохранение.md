### Прецендент: Открыть/сохранить
``` mermaid

sequenceDiagram
    autonumber

    participant User
    participant Main
    participant Editor
    participant Document
    participant CompositeManager
    participant ExportManager
    participant PdfAdapter
    participant JsonAdapter
    participant Cursor

    %% ==========================================
    %% 1) СОХРАНЕНИЕ В DOCX
    %% ==========================================

    Note over User,Editor: Пользователь сохраняет документ в DOCX

    User->>Main: Сохранить документ("mytext.docx")
    Main->>Editor: Export("docx", "mytext.docx")
    activate Editor

    Editor->>ExportManager: Export(currentDoc, "docx", "mytext.docx")
    activate ExportManager

    %% Получение текста документа через CompositeManager
    ExportManager->>Document: GetText()
    activate Document
    Document->>CompositeManager: Traverse(Document, GetText)
    activate CompositeManager
    CompositeManager-->>Document: text collected
    deactivate CompositeManager
    Document-->>ExportManager: fullText
    deactivate Document

    ExportManager-->>Editor: DOCX готов
    deactivate ExportManager

    Editor-->>Main: уведомление «Документ сохранён как DOCX»
    deactivate Editor


    %% ==========================================
    %% 2) ЭКСПОРТ В PDF
    %% ==========================================

    Note over User,Editor: Пользователь экспортирует документ в PDF

    User->>Main: Экспортировать документ("pdf", "mytext.pdf")
    Main->>Editor: Export("pdf", "mytext.pdf")
    activate Editor

    Editor->>ExportManager: Export(currentDoc, "pdf", "mytext.pdf")
    activate ExportManager

    ExportManager->>Document: GetText()
    activate Document
    Document->>CompositeManager: Traverse(Document, GetText)
    activate CompositeManager
    CompositeManager-->>Document: text collected
    deactivate CompositeManager
    Document-->>ExportManager: fullText
    deactivate Document

    %% При необходимости учитываем курсор
    ExportManager->>Cursor: currentElementId
    Cursor-->>ExportManager: position info

    ExportManager->>PdfAdapter: ExportFromDocx("temp/mytext.docx", "mytext.pdf")
    activate PdfAdapter
    PdfAdapter-->>ExportManager: pdf готов
    deactivate PdfAdapter

    ExportManager-->>Editor: экспорт PDF завершён
    deactivate ExportManager

    Editor-->>Main: уведомление «Экспорт в PDF успешен»
    deactivate Editor


    %% ==========================================
    %% 3) ЭКСПОРТ В JSON
    %% ==========================================

    Note over User,Editor: Пользователь экспортирует документ в JSON

    User->>Main: Экспортировать документ("json", "mytext.json")
    Main->>Editor: Export("json", "mytext.json")
    activate Editor

    Editor->>ExportManager: Export(currentDoc, "json", "mytext.json")
    activate ExportManager

    ExportManager->>Document: GetText()
    activate Document
    Document->>CompositeManager: Traverse(Document, GetText)
    activate CompositeManager
    CompositeManager-->>Document: text collected
    deactivate CompositeManager
    Document-->>ExportManager: fullText
    deactivate Document

    ExportManager->>Cursor: currentElementId
    Cursor-->>ExportManager: position info

    ExportManager->>JsonAdapter: ExportFromDocx("temp/mytext.docx", "mytext.json")
    activate JsonAdapter
    JsonAdapter-->>ExportManager: json готов
    deactivate JsonAdapter

    ExportManager-->>Editor: экспорт JSON завершён
    deactivate ExportManager

    Editor-->>Main: уведомление «Экспорт в JSON успешен»
    deactivate Editor




```
