### Прецендент: Открыть/сохранить
``` mermaid

sequenceDiagram
    participant Main
    participant Editor
    participant Document
    participant CompositeManager
    participant ExportManager
    participant PdfAdapter
    participant JsonAdapter
    participant FileSystem

    Note over Main, Editor: 1) СОХРАНЕНИЕ ДОКУМЕНТА (в DOCX)

    Main->>Editor: Export("docx", "mytext.docx")
    activate Editor
    Editor->>ExportManager: Export(currentDoc, "docx", "mytext.docx")
    activate ExportManager

    ExportManager->>Document: GetText()  %% обход Composite для создания DOCX
    activate Document
    loop Traverse(Document)
        Document->>CompositeManager: Traverse(Paragraph)
        CompositeManager->>Paragraph: GetText()
        Paragraph->>CompositeManager: Traverse(Sentence)
        CompositeManager->>Sentence: GetText()
        Sentence->>CompositeManager: Traverse(Word)
        CompositeManager->>Word: GetText()
    end
    deactivate Document

    ExportManager->>FileSystem: WriteFile("temp/mytext.docx")
    FileSystem-->>ExportManager: ok
    ExportManager-->>Editor: DOCX сохранён
    deactivate ExportManager
    Editor-->>Main: файл сохранён как DOCX
    deactivate Editor

    Note over Main, Editor: 2) ЭКСПОРТ В PDF

    Main->>Editor: Export("pdf", "mytext.pdf")
    activate Editor
    Editor->>ExportManager: Export(currentDoc, "pdf", "mytext.pdf")
    activate ExportManager

    ExportManager->>Document: GetText()
    activate Document
    loop Traverse(Document)
        Document->>CompositeManager: Traverse(Paragraph)
        CompositeManager->>Paragraph: GetText()
        Paragraph->>CompositeManager: Traverse(Sentence)
        CompositeManager->>Sentence: GetText()
        Sentence->>CompositeManager: Traverse(Word)
        CompositeManager->>Word: GetText()
    end
    deactivate Document

    ExportManager->>PdfAdapter: ExportFromDocx("temp/mytext.docx", "mytext.pdf")
    activate PdfAdapter
    PdfAdapter->>FileSystem: Convert DOCX → PDF
    FileSystem-->>PdfAdapter: pdf готов
    PdfAdapter-->>ExportManager: ok
    deactivate PdfAdapter

    ExportManager-->>Editor: экспорт завершён
    deactivate ExportManager
    Editor-->>Main: уведомление «Экспорт в PDF успешен»
    deactivate Editor

    Note over Main, Editor: 3) ЭКСПОРТ В JSON

    Main->>Editor: Export("json", "mytext.json")
    activate Editor
    Editor->>ExportManager: Export(currentDoc, "json", "mytext.json")
    activate ExportManager

    ExportManager->>Document: GetText()
    activate Document
    loop Traverse(Document)
        Document->>CompositeManager: Traverse(Paragraph)
        CompositeManager->>Paragraph: GetText()
        Paragraph->>CompositeManager: Traverse(Sentence)
        CompositeManager->>Sentence: GetText()
        Sentence->>CompositeManager: Traverse(Word)
        CompositeManager->>Word: GetText()
    end
    deactivate Document

    ExportManager->>JsonAdapter: ExportFromDocx("temp/mytext.docx", "mytext.json")
    activate JsonAdapter
    JsonAdapter->>FileSystem: Convert DOCX → JSON
    FileSystem-->>JsonAdapter: json готов
    JsonAdapter-->>ExportManager: ok
    deactivate JsonAdapter

    ExportManager-->>Editor: экспорт завершён
    deactivate ExportManager
    Editor-->>Main: уведомление «Экспорт в JSON успешен»
    deactivate Editor



```
