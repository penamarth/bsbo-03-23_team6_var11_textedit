### Прецендент: Открыть/сохранить
``` mermaid

sequenceDiagram
    actor Main
    participant Editor
    participant Document
    participant CompositeManager
    participant ExportManager
    participant PdfAdapter
    participant JsonAdapter
    participant Paragraph
    participant Sentence
    participant Word
    participant Letter

    Main->>Editor: OpenDocument(path, format)
    Editor->>Document: <<constructor>>(name from file)
    Editor->>CompositeManager: Traverse and build nodes
    CompositeManager->>Document: Add(Paragraph)
    Document->>Paragraph: <<constructor>>()
    CompositeManager->>Paragraph: Add(Sentence)
    Paragraph->>Sentence: <<constructor>>()
    CompositeManager->>Sentence: Add(Word)
    Sentence->>Word: <<constructor>>()
    CompositeManager->>Word: Add(Letter)
    Word->>Letter: <<constructor>>()
    Editor-->>Main: Document готов

    Editor->>ExportManager: Export(document, "pdf", outputPath)
    ExportManager->>ExportManager: SaveToDocx(document, tempPath)
    ExportManager->>Document: GetText() / Traverse()
    Document->>CompositeManager: GetText(document)
    CompositeManager->>Document: Traverse(node, collect text)
    CompositeManager-->>ExportManager: text/structure
    ExportManager->>ExportManager: create DOCX(tempPath)
    ExportManager-->>Editor: docxPath

    alt format == "pdf"
        ExportManager->>PdfAdapter: ExportFromDocx(docxPath, outputPath)
        PdfAdapter-->>ExportManager: success
    else format == "json"
        ExportManager->>JsonAdapter: ExportFromDocx(docxPath, outputPath)
        JsonAdapter-->>ExportManager: success
    else format == "docx"
        ExportManager->>ExportManager: move temp docx → outputPath
    end

    ExportManager-->>Editor: Export result
    Editor->>Main: DisplayDocument / ShowErrors(if any)


```
