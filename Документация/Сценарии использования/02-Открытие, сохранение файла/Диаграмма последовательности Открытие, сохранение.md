### Прецендент: Открыть/сохранить
``` mermaid
sequenceDiagram
    autonumber
    participant UI as Interface
    participant ED as Editor
    participant DOC as Document
    participant BASE as DocxDocument
    participant ROOT as DocumentComponent
    participant PDF as PdfAdapter
    participant JSON as JsonAdapter

    %% A) ОТКРЫТИЕ
    UI->>ED: RequestAction("OpenDocument", path)
    ED->>DOC: Load(path)
    note right of DOC: Load заполняет baseDoc.Content и строит rootComponent
    DOC->>BASE: baseDoc.LoadFrom(path)  -- (парсинг формата docx)
    BASE-->>DOC: content (docx content)
    DOC->>ROOT: ParseContentToComponents(baseDoc.GetContent())
    ROOT-->>DOC: rootComponent built
    DOC-->>ED: loaded
    ED->>UI: ShowDocument(DOC)

    %% B) СОХРАНЕНИЕ В DOCX
    UI->>ED: RequestAction("Save")
    ED->>DOC: Save()
    DOC->>BASE: baseDoc.SetContent(DOC.GetText())
    BASE-->>DOC: content set
    DOC->>BASE: baseDoc.Export(path_docx)
    BASE-->>DOC: export success
    DOC-->>ED: saved
    ED->>UI: ShowDocument(DOC) (saved confirmation)

    %% C) ЭКСПОРТ В PDF и JSON через адаптеры
    UI->>ED: RequestAction("Export", "pdf", path_pdf)
    ED->>DOC: GetBaseDoc() -> baseDoc
    ED->>PDF: new PdfAdapter(baseDoc)
    PDF-->>ED: adapter created
    ED->>PDF: PDF.Export(path_pdf)
    PDF->>BASE: baseDoc.GetContent()
    BASE-->>PDF: docx content
    PDF->>PDF: ConvertToPDF(content)
    PDF-->>ED: export success
    ED->>UI: ShowDocument(DOC) (exported confirmation)

    UI->>ED: RequestAction("Export", "json", path_json)
    ED->>DOC: GetBaseDoc() -> baseDoc
    ED->>JSON: new JsonAdapter(baseDoc)
    JSON-->>ED: adapter created
    ED->>JSON: JSON.Export(path_json)
    JSON->>BASE: baseDoc.GetContent()
    BASE-->>JSON: docx content
    JSON->>JSON: ConvertToJSON(content)
    JSON-->>ED: export success
    ED->>UI: ShowDocument(DOC) (exported confirmation)

```
