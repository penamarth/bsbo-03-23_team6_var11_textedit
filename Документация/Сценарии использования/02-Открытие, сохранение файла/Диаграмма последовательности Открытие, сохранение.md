### Прецендент: Открыть/сохранить
``` mermaid

sequenceDiagram
    autonumber
    participant Main as Main (UI)
    participant Editor as Editor
    participant Document as Document
    participant ExportManager as ExportManager
    participant PdfAdapter as PdfAdapter
    participant JsonAdapter as JsonAdapter

    %% === ОТКРЫТИЕ ДОКУМЕНТА ===
    Main->>Editor: open_document(file_path="example.docx")
    activate Editor
    Editor->>Document: __init__(name="example")
    Editor->>Document: load(file_path="example.docx")
    activate Document
    Note right of Document: Загружает структуру Paragraph → Sentence → Word → Letter
    Document-->>Editor: return Document объект
    deactivate Document
    Editor-->>Main: return "Документ готов к отображению"
    deactivate Editor
    Main->>Main: render_document_view()

    %% === РЕДАКТИРОВАНИЕ ===
    Note over Main,Editor: Пользователь изменяет содержимое в UI, Editor обновляет Document.update_structure()

    %% === СОХРАНЕНИЕ В DOCX ===
    Main->>Editor: export(format="docx", output_path="output.docx")
    activate Editor
    Editor->>ExportManager: export(document, format="docx", output_path)
    activate ExportManager
    ExportManager->>Document: get_text()
    activate Document
    Document-->>ExportManager: return structured_text
    deactivate Document
    ExportManager->>ExportManager: save_docx(output_path, structured_text)
    Note right of ExportManager: Сохраняет документ в формате .docx
    ExportManager-->>Editor: return True
    deactivate ExportManager
    Editor-->>Main: notify("Документ сохранён в output.docx")
    deactivate Editor

    %% === ЭКСПОРТ В PDF ===
    Main->>Editor: export(format="pdf", output_path="output.pdf")
    activate Editor
    Editor->>ExportManager: export(document, format="pdf", output_path)
    activate ExportManager
    ExportManager->>Document: get_text()
    Document-->>ExportManager: return structured_text
    ExportManager->>ExportManager: save_docx("temp.docx", structured_text)
    ExportManager->>PdfAdapter: export_from_docx(input="temp.docx", output="output.pdf")
    activate PdfAdapter
    PdfAdapter-->>ExportManager: return True
    deactivate PdfAdapter
    ExportManager-->>Editor: return True
    deactivate ExportManager
    Editor-->>Main: notify("Экспорт завершён: output.pdf")
    deactivate Editor

    %% === ЭКСПОРТ В JSON ===
    Main->>Editor: export(format="json", output_path="output.json")
    activate Editor
    Editor->>ExportManager: export(document, format="json", output_path)
    activate ExportManager
    ExportManager->>Document: get_text()
    Document-->>ExportManager: return structured_text
    ExportManager->>ExportManager: save_docx("temp.docx", structured_text)
    ExportManager->>JsonAdapter: export_from_docx(input="temp.docx", output="output.json")
    activate JsonAdapter
    JsonAdapter-->>ExportManager: return True
    deactivate JsonAdapter
    ExportManager-->>Editor: return True
    deactivate ExportManager
    Editor-->>Main: notify("Экспорт завершён: output.json")
    deactivate Editor




```
