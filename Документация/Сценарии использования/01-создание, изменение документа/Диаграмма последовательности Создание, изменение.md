# Прецедент 1: Создание и редактирование документа
```mermaid
sequenceDiagram
    autonumber
    actor Main
    participant Editor
    participant CompositeManager
    participant Document
    participant Paragraph
    participant Sentence
    participant Word
    participant Letter

    %% === Создание нового документа ===
    Main->>Editor: NewDocument("MyDoc")
    activate Editor
    Editor->>Document: __init__(name="MyDoc")
    activate Document
    Note right of Document: self.paragraphs = []
    Document-->>Editor: Document создан
    deactivate Document
    Editor-->>Main: Обновить UI (показать пустой документ)
    deactivate Editor

    %% === Добавление параграфа ===
    Main->>Editor: Добавить параграф
    Editor->>CompositeManager: Add(Document, Paragraph)
    activate CompositeManager
    CompositeManager->>Paragraph: __init__()
    CompositeManager->>Document: add_child(Paragraph)
    deactivate CompositeManager
    Editor-->>Main: Обновить UI (новый параграф)

    %% === Добавление предложения ===
    Main->>Editor: Добавить предложение
    Editor->>CompositeManager: Add(Paragraph, Sentence)
    activate CompositeManager
    CompositeManager->>Sentence: __init__()
    CompositeManager->>Paragraph: add_child(Sentence)
    deactivate CompositeManager
    Editor-->>Main: Обновить UI (новое предложение)

    %% === Добавление слова и букв ===
    Main->>Editor: Добавить слово "Hi"
    Editor->>CompositeManager: Add(Sentence, Word("Hi"))
    activate CompositeManager
    CompositeManager->>Word: __init__(text="Hi")
    CompositeManager->>Sentence: add_child(Word)
    
    loop для каждой буквы в "Hi"
        CompositeManager->>Letter: __init__(char)
        CompositeManager->>Word: add_child(Letter)
    end
    deactivate CompositeManager
    Editor-->>Main: Обновить UI (добавлено слово "Hi")

    Note over Editor,Document: Document → Paragraph → Sentence → Word("Hi") → Letters('H','i')

    %% === Получение текста ===
    Main->>Editor: GetText(Document)
    Editor->>CompositeManager: GetText(Document)
    activate CompositeManager
    CompositeManager->>Document: traverse(node, action="collect_text")
    activate Document
    Document->>Paragraph: traverse(action="collect_text")
    activate Paragraph
    Paragraph->>Sentence: traverse(action="collect_text")
    activate Sentence
    Sentence->>Word: get_text()  // возвращает "Hi"
    deactivate Sentence
    deactivate Paragraph
    deactivate Document
    CompositeManager-->>Editor: "Hi"
    deactivate CompositeManager
    Editor-->>Main: Показать текст "Hi"

    %% === Поиск текста ===
    Main->>Editor: FindText("Hi")
    Editor->>CompositeManager: FindText(Document, "Hi")
    activate CompositeManager
    CompositeManager->>Document: traverse(node, action="find", pattern="Hi")
    activate Document
    Document->>Paragraph: traverse(action="find")
    Paragraph->>Sentence: traverse(action="find")
    Sentence->>Word: match_text("Hi")
    deactivate Document
    CompositeManager-->>Editor: позиции совпадений
    deactivate CompositeManager
    Editor-->>Main: Показать найденные совпадения

    %% === Замена текста ===
    Main->>Editor: ReplaceText("Hi" → "Hello")
    Editor->>CompositeManager: ReplaceText(Document, "Hi", "Hello")
    activate CompositeManager
    CompositeManager->>Document: traverse(node, action="replace", old="Hi", new="Hello")
    activate Document
    Document->>Paragraph: traverse(action="replace")
    Paragraph->>Sentence: traverse(action="replace")
    Sentence->>Word: if get_text() == "Hi": replace_text("Hello")
    activate Word
    Word->>Letter: clear_letters()
    Word->>Letter: create_letters(['H','e','l','l','o'])
    deactivate Word
    deactivate Document
    CompositeManager-->>Editor: заменено 1 слово
    deactivate CompositeManager
    Editor-->>Main: Обновить UI ("Hello" видно)




```


