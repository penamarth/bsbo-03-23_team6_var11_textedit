# Прецедент 1: Создание и редактирование документа
```mermaid
sequenceDiagram
    autonumber
    participant UI as Interface
    participant ED as Editor
    participant DOC as Document
    participant BASE as DocxDocument
    participant ROOT as DocumentComponent
    participant PARA as ParagraphComponent
    participant SENT as SentenceComponent
    participant WORD as WordComponent
    participant LETTER as LetterComponent

    UI->>ED: RequestAction("NewDocument", name)
    note right of ED: Создать новый Document и базовый Docx
    ED->>DOC: CreateNew(name)
    DOC-->>ED: Document instance
    ED->>BASE: new DocxDocument()
    BASE-->>DOC: baseDoc assigned
    DOC->>ROOT: Create root DocumentComponent()
    ROOT-->>DOC: rootComponent assigned
    ED->>UI: ShowDocument(DOC)
    note right of UI: Пользователь видит пустой документ

    %% пользователь вводит текст: "Hello"
    UI->>ED: RequestAction("InsertText", "Hello")
    ED->>DOC: GetText() or SetText("Hello")
    DOC-->>ED: confirmed
    ED->>ROOT: rootComponent.Add(ParagraphComponent)
    ROOT-->>ED: paragraph added
    ED->>PARA: new ParagraphComponent()
    PARA-->>ED: paragraph instance
    ED->>PARA: PARA.Add(SentenceComponent)
    PARA-->>ED: sentence added
    ED->>SENT: new SentenceComponent()
    SENT-->>ED: sentence instance
    ED->>SENT: SENT.Add(WordComponent)
    SENT-->>ED: word added
    ED->>WORD: new WordComponent("Hello")
    WORD-->>SENT: word instance
    ED->>WORD: WORD.Add(LetterComponent 'H'...'o')
    WORD-->>ED: letters added
    ED->>DOC: MarkModified(true)
    ED->>UI: ShowDocument(DOC)  -- updated view with text

```


