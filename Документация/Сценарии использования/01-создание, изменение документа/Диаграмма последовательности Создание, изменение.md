# Прецедент 1: Создание и редактирование документа
```mermaid
sequenceDiagram
    actor User as Пользователь
    participant Editor as Editor
    participant DocumentManager as DocumentManager
    participant Document as Document
    participant SyntaxHighlighter as SyntaxHighlighter
    participant HighlightToken as HighlightToken

    %% Создание нового документа
    User->>Editor: NewDocument(name="Untitled")
    activate Editor
    Editor->>DocumentManager: CreateNew(name="Untitled")
    activate DocumentManager
    DocumentManager->>Document: CreateNew(name)
    activate Document
    Document-->>DocumentManager: Document{id, Name, Format, Content=""}
    deactivate Document
    DocumentManager-->>Editor: Document (новый)
    deactivate DocumentManager
    Editor->>Editor: Set CurrentDocument = Document
    Editor-->>User: UI: новая вкладка/пустой документ
    deactivate Editor

    %% Изменение содержимого пользователем
    User->>Editor: InsertText("print('hello')")
    activate Editor
    Editor->>Document: AppendText("print('hello')")
    activate Document
    Document-->>Editor: OK (IsModified = true)
    deactivate Document

    %% Обновление подсветки после изменения
    Editor->>SyntaxHighlighter: Highlight(Document.Content, Document.Format)
    activate SyntaxHighlighter
    SyntaxHighlighter->>HighlightToken: create token(s) for ranges/types
    activate HighlightToken
    HighlightToken-->>SyntaxHighlighter: tokenList
    deactivate HighlightToken
    SyntaxHighlighter-->>Editor: List~HighlightToken~
    deactivate SyntaxHighlighter

    Editor-->>User: UI обновляет подсветку/курсор
    deactivate Editor
```


