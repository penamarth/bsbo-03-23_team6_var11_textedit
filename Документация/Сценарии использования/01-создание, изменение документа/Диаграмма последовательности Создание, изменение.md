# Прецедент 1: Создание и редактирование документа
```mermaid
sequenceDiagram
    autonumber
    actor Main
    participant Editor
    participant CompositeManager
    participant Document
    participant Paragraph
    participant Sentence
    participant Word
    participant Letter

   
    Main->>Editor: NewDocument("MyDoc")
    activate Editor
    Editor->>Document: Создать документ "MyDoc"
    activate Document
    Note right of Document: Пустой список параграфов
    Document-->>Editor: Документ создан
    deactivate Document
    Editor-->>Main: Показать новый документ
    deactivate Editor

   
    Main->>Editor: Add Paragraph
    Editor->>CompositeManager: Add(Document, Paragraph)
    activate CompositeManager
    CompositeManager->>Paragraph: Создать Paragraph
    CompositeManager->>Document: Add(Paragraph)
    CompositeManager-->>Editor: Параграф добавлен
    deactivate CompositeManager
    Editor-->>Main: Обновить интерфейс

   
    Main->>Editor: Add Sentence
    Editor->>CompositeManager: Add(Paragraph, Sentence)
    activate CompositeManager
    CompositeManager->>Sentence: Создать Sentence
    CompositeManager->>Paragraph: Add(Sentence)
    CompositeManager-->>Editor: Предложение добавлено
    deactivate CompositeManager
    Editor-->>Main: Обновить интерфейс


    Main->>Editor: Add Word("Hi")
    Editor->>CompositeManager: Add(Sentence, Word)
    activate CompositeManager
    CompositeManager->>Word: Создать Word("Hi")
    CompositeManager->>Sentence: Add(Word)

    loop для каждой буквы "H", "i"
        CompositeManager->>Letter: Создать Letter(char)
        CompositeManager->>Word: Add(Letter)
    end

    CompositeManager-->>Editor: Слово добавлено
    deactivate CompositeManager
    Editor-->>Main: Обновить интерфейс

    Note over Editor,Document: Document → Paragraph → Sentence → Word("Hi") → Letters('H','i')

    
    Main->>Editor: GetText(Document)
    Editor->>CompositeManager: GetText(Document)
    activate CompositeManager
    CompositeManager->>Document: Traverse(action="collect_text")
    activate Document
    Document->>Paragraph: Traverse(action="collect_text")
    Paragraph->>Sentence: Traverse(action="collect_text")
    Sentence->>Word: GetText() → "Hi"
    deactivate Document
    CompositeManager-->>Editor: "Hi"
    deactivate CompositeManager
    Editor-->>Main: Показать текст "Hi"

 
    Main->>Editor: FindText("Hi")
    Editor->>CompositeManager: FindText(Document, "Hi")
    activate CompositeManager
    CompositeManager->>Document: Traverse(action="find", pattern="Hi")
    Document->>Paragraph: Traverse(action="find")
    Paragraph->>Sentence: Traverse(action="find")
    Sentence->>Word: MatchText("Hi")
    CompositeManager-->>Editor: Позиции совпадений
    deactivate CompositeManager
    Editor-->>Main: Показать найденные совпадения

   
    Main->>Editor: ReplaceText("Hi" → "Hello")
    Editor->>CompositeManager: ReplaceText(Document, "Hi", "Hello")
    activate CompositeManager
    CompositeManager->>Document: Traverse(action="replace", old="Hi", new="Hello")
    Document->>Paragraph: Traverse(action="replace")
    Paragraph->>Sentence: Traverse(action="replace")
    Sentence->>Word: If GetText() == "Hi" → ReplaceText("Hello")
    activate Word
    Word->>Letter: Очистить и создать новые Letters('H','e','l','l','o')
    deactivate Word
    CompositeManager-->>Editor: Замена завершена
    deactivate CompositeManager
    Editor-->>Main: Обновить интерфейс ("Hello" видно)

   
    Main->>Editor: Remove(Word)
    Editor->>CompositeManager: Remove(Sentence, Word)
    activate CompositeManager
    CompositeManager->>Sentence: Remove(Word)
    CompositeManager-->>Editor: Элемент удалён
    deactivate CompositeManager
    Editor-->>Main: Обновить интерфейс

   
    Main->>Editor: CountElements(Document)
    Editor->>CompositeManager: CountElements(Document)
    activate CompositeManager
    CompositeManager->>Document: Traverse(action="count")
    Document->>Paragraph: Traverse(action="count")
    Paragraph->>Sentence: Traverse(action="count")
    Sentence->>Word: Traverse(action="count")
    CompositeManager-->>Editor: Результат (Параграфов=1, Предложений=1, Слов=1, Букв=5)
    deactivate CompositeManager
    Editor-->>Main: Показать статистику

   
    Main->>Editor: Traverse(Document, action)
    Editor->>CompositeManager: Traverse(Document, action)
    activate CompositeManager
    CompositeManager->>Document: Traverse(action)
    Document->>Paragraph: Traverse(action)
    Paragraph->>Sentence: Traverse(action)
    Sentence->>Word: Traverse(action)
    CompositeManager-->>Editor: Обход завершён
    deactivate CompositeManager
    Editor-->>Main: Результаты обхода





```


