# Прецендент 3: Печать
```mermaid
sequenceDiagram
    actor User as Пользователь
    participant Editor as Editor
    participant PrintManager as PrintManager
    participant PrintPreview as PrintPreview
    participant PrintSettings as PrintSettings
    participant Document as Document
    participant SyntaxHighlighter as SyntaxHighlighter
    participant HighlightToken as HighlightToken
    User->>Editor: PrintCurrent(settings: PrintSettings)
    activate Editor
    Editor->>PrintManager: ShowPreview(Document, settings)
    activate PrintManager
    PrintManager->>PrintPreview: GeneratePreview(Document, settings)
    activate PrintPreview
    PrintPreview->>Document: GetText()/GetLayoutInfo()
    activate Document
    Document-->>PrintPreview: Content + LayoutMeta
    deactivate Document
    PrintPreview->>SyntaxHighlighter: Highlight(Content, Document.Format)
    activate SyntaxHighlighter
    SyntaxHighlighter->>HighlightToken: create tokens for ranges/types
    activate HighlightToken
    HighlightToken-->>SyntaxHighlighter: tokenList
    deactivate HighlightToken
    SyntaxHighlighter-->>PrintPreview: List~HighlightToken~
    deactivate SyntaxHighlighter
    PrintPreview-->>PrintManager: PreviewImage (пагинированный)
    deactivate PrintPreview
    PrintManager-->>Editor: PreviewReady(preview)
    deactivate PrintManager
    Editor-->>User: Показываем предпросмотр (Preview)
    User->>Editor: ConfirmPrint()
    activate Edito
    Editor->>PrintManager: Print(Document, settings)
    activate PrintManager
    PrintManager->>Document: GetPrintableData(settings)
    activate Document
    Document-->>PrintManager: PrintablePages
    deactivate Document
    PrintManager-->>Editor: PrintJobAccepted (jobId)
    deactivate PrintManager
    Editor-->>User: UI: "Print started"
    deactivate Editor

```


